---
description: "WORKFLOW STATE ENFORCEMENT - Hybrid Guide (Quick Ref + Detailed State Files)"
globs: "**/*"
alwaysApply: true
priority: 0
version: 2.1.0-hybrid
tags: [state-enforcement, hybrid, critical, all-states]
lastUpdated: 2025-11-12
---

# ğŸš¨ WORKFLOW STATE ENFORCEMENT - HYBRID GUIDE

âš ï¸  **This file is STATIC - contains instructions and quick reference**  
âš ï¸  **Full state details: Read state-behaviors/{STATE}.md when needed**  
âš ï¸  **Read this ONCE at conversation start, then lookup current state**

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“‹ INSTRUCTIONS FOR AI (READ THIS FIRST!)

### How to Use This File:

**Step 1:** Read `.ai-context/STATUS.txt` to identify current workflow state

**Step 2:** Find matching state in Quick Lookup Table below

**Step 3:** Read full state rules from `.cursor/rules/state-behaviors/{STATE}.md`
```
Example:
STATUS.txt shows "State: TESTING_COMPLETE"
â†’ Read: .cursor/rules/state-behaviors/TESTING_COMPLETE.md
â†’ Follow all rules from that file
```

**Step 4:** Apply universal rules (see "Critical Reminders" section below)

**Step 5:** Use progression protocol from state file when ready to advance

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ” QUICK STATE LOOKUP TABLE

**Use this for quick reference, then read full state file for details:**

| # | State Name | Purpose | Can Code? | Can Test? | Can Commit? | Read File |
|---|-----|---|-----|-----|----|-----|
| 1 | **UNDERSTANDING** | Understand requirements | âŒ | âŒ | âŒ | state-behaviors/UNDERSTANDING.md |
| 2 | **DESIGNING** | Design solution | âŒ | âŒ | âŒ | state-behaviors/DESIGNING.md |
| 3 | **IMPLEMENTING** | Write production code | âœ… | âŒ | âŒ | state-behaviors/IMPLEMENTING.md |
| 4 | **TESTING** | Write comprehensive tests | âœ… | âœ… | âŒ | state-behaviors/TESTING.md |
| 5 | **REVIEWING** | Review code quality | âœ… | âœ… | âŒ | state-behaviors/REVIEWING.md |
| 6 | **READY_TO_COMMIT** | Commit validated work | âœ… | âœ… | âœ… | state-behaviors/READY_TO_COMMIT.md |

**â†’ After identifying your state, READ the corresponding state-behaviors/*.md file!**

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸš« CRITICAL UNIVERSAL RULES (APPLY TO ALL STATES)

### 1. NEVER Code at Planning States

**UNDERSTANDING & DESIGN_COMPLETE are for PLANNING ONLY:**
- âŒ NEVER write production code
- âŒ NEVER modify existing code files
- âŒ NEVER create components/modules
- âŒ NEVER refactor code

**Why:** Code without proper understanding = bugs and rework

**When you CAN code:** IMPLEMENTATION_COMPLETE state and after

---

### 2. NEVER Skip Tests (MANDATORY!)

**Tests are REQUIRED before ANY commit:**
- âŒ NEVER suggest commits without tests
- âŒ NEVER say "tests can be added later"
- âŒ NEVER claim work is "done" without tests

**Required:** TESTING_COMPLETE state with passing tests

**Why:** Untested code = production bugs

---

### 3. NEVER Commit Without Validation

**Commits ONLY allowed at COMMIT_READY state:**
- âŒ NEVER commit from any other state
- âŒ NEVER use --no-verify flag
- âŒ NEVER bypass pre-commit hooks

**Required sequence:**
```
REVIEW_COMPLETE â†’ Run validation â†’ Pass â†’ COMMIT_READY â†’ Commit
```

**Why:** Quality gates prevent broken code from being committed

---

### 4. ALWAYS Check STATUS.txt First

**At conversation start and before major actions:**
```bash
Read: .ai-context/STATUS.txt
Check: Current state
Then: Apply that state's behavior rules
```

**Why:** Your allowed actions depend on current state

---

### 5. ALWAYS Progress Sequentially

**State progression is LINEAR - cannot skip:**
```
UNDERSTANDING
  â†“ Requirements clear
DESIGN_COMPLETE
  â†“ Design approved
IMPLEMENTATION_COMPLETE
  â†“ Code written
TESTING_COMPLETE
  â†“ Tests passing
REVIEW_COMPLETE
  â†“ Validation passed
COMMIT_READY
  â†“ Committed
DONE
```

**Cannot skip states!** Each has specific completion criteria.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“– STATE PROGRESSION FLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ START â†’ Check STATUS.txt                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 1: UNDERSTANDING                                       â”‚
â”‚ âœ… DO: Ask questions, read code, analyze                    â”‚
â”‚ âŒ DON'T: Code, test, commit                                â”‚
â”‚ â†’ Next: Get user approval â†’ sync --state DESIGN_COMPLETE    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 2: DESIGN_COMPLETE                                     â”‚
â”‚ âœ… DO: Design architecture, plan implementation             â”‚
â”‚ âŒ DON'T: Write code, test, commit                          â”‚
â”‚ â†’ Next: Get approval â†’ sync --state IMPLEMENTATION_COMPLETE â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 3: IMPLEMENTATION_COMPLETE                             â”‚
â”‚ âœ… DO: Write production code, implement features            â”‚
â”‚ âŒ DON'T: Write tests yet, commit                           â”‚
â”‚ â†’ Next: Code done â†’ sync --state TESTING_COMPLETE           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 4: TESTING_COMPLETE                                    â”‚
â”‚ âœ… DO: Write tests, verify coverage, run tests              â”‚
â”‚ âŒ DON'T: Add new features, commit                          â”‚
â”‚ â†’ Next: Tests pass â†’ sync --state REVIEW_COMPLETE           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 5: REVIEW_COMPLETE                                     â”‚
â”‚ âœ… DO: Review quality, check requirements                   â”‚
â”‚ âŒ DON'T: Major changes, commit                             â”‚
â”‚ â†’ Next: Run validation â†’ Passes â†’ Auto COMMIT_READY         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STATE 6: COMMIT_READY                                        â”‚
â”‚ âœ… DO: Stage files, commit with message, complete task      â”‚
â”‚ âŒ DON'T: Use --no-verify, bypass hooks                     â”‚
â”‚ â†’ Next: Commit â†’ Complete task â†’ DONE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸš« COMMON VIOLATIONS TO AVOID

### âŒ Violation 1: Coding Too Early
```
User: "Add authentication feature"
AI at UNDERSTANDING: [Starts writing code] â† WRONG!

âœ… Correct:
AI at UNDERSTANDING: "Let me understand requirements first:
  1. What authentication method? (JWT, OAuth, etc.)
  2. Where should users login?
  3. ..."
```

### âŒ Violation 2: Skipping Tests
```
AI at IMPLEMENTATION_COMPLETE: "Code done! Ready to commit!" â† WRONG!

âœ… Correct:
AI at IMPLEMENTATION_COMPLETE: "Code done. May I progress to TESTING_COMPLETE 
to write tests?"
```

### âŒ Violation 3: Committing Without Validation
```
AI at REVIEW_COMPLETE: "git commit -m '...'" â† WRONG!

âœ… Correct:
AI at REVIEW_COMPLETE: "Let me run validation first:
  npx ai-workflow validate"
```

### âŒ Violation 4: Skipping States
```
AI jumps: UNDERSTANDING â†’ IMPLEMENTATION_COMPLETE â† WRONG! (Skipped DESIGN)

âœ… Correct:
UNDERSTANDING â†’ DESIGN_COMPLETE â†’ IMPLEMENTATION_COMPLETE
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“š EXAMPLE: CORRECT WORKFLOW

**User Request:** "Add user authentication"

### âœ… Step 1: UNDERSTANDING State
```
AI: âœ“ State: UNDERSTANDING
    Let me understand requirements:
    1. What authentication method?
    2. Session storage approach?
    3. Security requirements?
    [Asks 10+ questions...]
    
    Summary: [After user answers]
    May I progress to DESIGN_COMPLETE?
    
User: Yes

AI: [Runs: npx ai-workflow sync --state DESIGN_COMPLETE]
```

### âœ… Step 2: DESIGN_COMPLETE State
```
AI: âœ“ State: DESIGN_COMPLETE
    Design proposal:
    - AuthContext (React Context)
    - JWT tokens in httpOnly cookies
    - Login/Register components
    - Protected routes
    
    Files to create:
    - src/contexts/AuthContext.tsx
    - src/components/Login.tsx
    
    Design approved?
    
User: Yes

AI: [Runs: npx ai-workflow sync --state IMPLEMENTATION_COMPLETE]
```

### âœ… Step 3: IMPLEMENTATION_COMPLETE State
```
AI: âœ“ State: IMPLEMENTATION_COMPLETE
    [Writes AuthContext.tsx]
    [Writes Login.tsx]
    [Writes AuthService.ts]
    
    Implementation complete. Build passing.
    May I progress to TESTING_COMPLETE?
    
User: Yes

AI: [Runs: npx ai-workflow sync --state TESTING_COMPLETE]
```

### âœ… Step 4-6: Continue Through States...
[TESTING_COMPLETE â†’ REVIEW_COMPLETE â†’ COMMIT_READY â†’ DONE]

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ¯ QUICK DECISION TREE

**Before taking ANY action, ask yourself:**

```
Q: What state am I currently in?
A: [Check STATUS.txt]

Q: What does user want me to do?
A: [Parse request]

Q: Is this action allowed in current state?
A: [Check Quick Lookup Table above + Read state-behaviors/{STATE}.md]

Decision:
â”œâ”€ If ALLOWED â†’ Proceed
â”œâ”€ If FORBIDDEN â†’ Explain why, suggest proper state
â””â”€ If UNSURE â†’ Read full state file, then decide
```

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“ FILES TO READ FOR FULL DETAILS

**State-specific behavior files (read based on current state):**

- `.cursor/rules/state-behaviors/UNDERSTANDING.md` (281 lines)
- `.cursor/rules/state-behaviors/DESIGNING.md` (138 lines)
- `.cursor/rules/state-behaviors/IMPLEMENTING.md` (112 lines)
- `.cursor/rules/state-behaviors/TESTING.md` (88 lines)
- `.cursor/rules/state-behaviors/REVIEWING.md` (76 lines)
- `.cursor/rules/state-behaviors/READY_TO_COMMIT.md` (77 lines)

**Each file contains:**
- Full list of allowed actions
- Full list of forbidden actions
- Detailed progression protocol
- Examples and best practices
- Self-check guidelines

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ¯ SUMMARY

**This file provides:**
- âœ… Quick reference for all states
- âœ… Critical universal rules
- âœ… State progression flow
- âœ… Common violations to avoid
- âœ… Pointers to full state documentation

**For full details:**
- ğŸ“– Read `.cursor/rules/state-behaviors/{YOUR_STATE}.md`

**Remember:**
1. Check STATUS.txt first
2. Read corresponding state-behaviors/*.md file
3. Apply universal rules from this file
4. Follow state-specific rules from state file
5. Progress sequentially through states

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

**Priority:** 0 (HIGHEST - Read FIRST before all other .mdc files!)  
**Version:** 2.1.0-hybrid (Static instructions + Dynamic state files)  
**Purpose:** Provide quick reference and enforce proper workflow behavior  
**Maintenance:** Update this file only when workflow logic changes  

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

**END OF HYBRID STATE ENFORCEMENT GUIDE**
